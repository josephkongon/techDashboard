import{f as v,h as L,i as F,k as b,l as N,m as C,r as P,j as s}from"./index-yuUUyctO.js";import{A as k}from"./AuthLayout-BCqIpw78.js";import{c as E,a as h,o as S}from"./index.esm-BKlfNqTZ.js";import{u as A,C as x}from"./index.esm-BmK1oTla.js";import{u as B,s as g}from"./index-CaWbZqE4.js";import{a as T,S as I}from"./index-CBw9tgfC.js";import{F as j,a as y,b as w,c as f}from"./FormLabel-w72VCfxw.js";import{B as U,C as q}from"./index-D-Sl4BCG.js";import{u as M}from"./useTranslation-BT0VEfT5.js";import{B as $}from"./Button-B0wmy4O4.js";import"./logo-dark-BAoMPR9Z.js";import"./logo-light-D6mHfsDh.js";import"./Row-Bd_6pW-A.js";import"./Col-C9voJz8y.js";import"./Card-BQqG1lle.js";import"./CardHeaderContext-CR2EohSr.js";import"./warning-DlN2PdZY.js";import"./index-CI1nDiKN.js";import"./index-Chjiymov.js";import"./iconBase-DajP4cR_.js";import"./Button-p2pLIQWZ.js";const G=async r=>T.post("/auth/login",r).then(m=>m.data),O=()=>{const r=v(),m=L(),{saveSession:d}=F(),[p]=b(),{isLoading:c,mutateAsync:u}=B(async i=>G(i)),l=E({email:h().email("Please enter a valid email").required("Please enter your email"),password:h().required("Please enter your password")}),{control:e,handleSubmit:o}=A({resolver:S(l),defaultValues:{email:"",password:""}}),a=()=>{const i=p.get("redirectTo");r(i||"/")},t=o(async i=>{u({email:i.email,password:i.password},{onSuccess:async n=>{g.success("Login successful"),d({...n,token:n.accessToken}),m(N.setCurrentUser({currentUser:n})),C.set("userAuth",n),a()},onError:async n=>{console.log(n),g.error("Login failed.")}})});return{isLoading:c,handleLogin:t,control:e}},ms=()=>{const{t:r}=M(),{handleLogin:m,control:d,isLoading:p}=O(),[c,u]=P.useState(!1);return s.jsx(I,{spinning:p,children:s.jsx(k,{helpText:r("Enter your email address and password to access admin panel."),bottomLinks:s.jsx("div",{style:{paddingBottom:"2rem"}}),children:s.jsxs("form",{onSubmit:m,children:[s.jsx("div",{className:"mb-3",children:s.jsx(x,{name:"email",control:d,render:({field:l,fieldState:e})=>{var o,a,t;return s.jsxs(j,{children:[s.jsx(y,{htmlFor:"email",children:r("Email")}),s.jsx(w,{id:"email",...l,isInvalid:!!((o=e.error)!=null&&o.message)}),((a=e.error)==null?void 0:a.message)&&s.jsx(f,{type:"invalid",className:"text-danger",children:(t=e.error)==null?void 0:t.message})]})}})}),s.jsx("div",{className:"mb-3",children:s.jsx(x,{name:"password",control:d,render:({field:l,fieldState:e})=>{var o,a,t;return s.jsxs(j,{children:[s.jsx(y,{htmlFor:"password",children:r("Password")}),s.jsxs("div",{className:"position-relative",children:[s.jsx(w,{id:"password",type:c?"text":"password",...l,isInvalid:!!((o=e.error)!=null&&o.message)}),((a=e.error)==null?void 0:a.message)&&s.jsx(f,{type:"invalid",className:"text-danger",children:(t=e.error)==null?void 0:t.message}),s.jsx("span",{className:"d-flex position-absolute top-50 end-0 translate-middle-y p-0 pe-2 me-2",onClick:()=>u(!c),children:!e.error&&(c?s.jsx(U,{height:18,width:18,className:"cursor-pointer"}):s.jsx(q,{height:18,width:18,className:"cursor-pointer"}))})]})]})}})}),s.jsx("div",{className:"text-center d-grid",children:s.jsx($,{variant:"primary",type:"submit",children:r("Log In")})})]})})})};export{ms as default};

import{r as g,j as e,f as U}from"./index-yuUUyctO.js";import{F as y,B as p,u as I,a as O,P as k}from"./constand-2MzKY2H2.js";import{u as b,s as h}from"./index-CaWbZqE4.js";import{a as N,S}from"./index-CBw9tgfC.js";import{F as c}from"./index-D7ZmTkAm.js";import{M as P}from"./index-BEr-eB6r.js";import{I as C}from"./index-KHWGqfV2.js";import{u as F}from"./useDisclosure-BnWxVtk_.js";import{f as A}from"./format-DT9SbUHr.js";import{C as f}from"./Card-BQqG1lle.js";import{F as v}from"./Table-CSOoNIQu.js";import{u as M,P as T}from"./index-CtHykCd2.js";import{c as B}from"./order-Ce9Igb29.js";import{R as L}from"./Row-Bd_6pW-A.js";import{C as E}from"./Col-C9voJz8y.js";import"./Anchor-Dl5sMHsj.js";import"./useEventCallback-D9iA8xtn.js";import"./Button-p2pLIQWZ.js";import"./Input-DPA-4Z3o.js";import"./CardHeaderContext-CR2EohSr.js";import"./addEventListener-MtvHkOBD.js";import"./index-B81dbxI5.js";import"./index-zwwZ_c_4.js";import"./warning-DlN2PdZY.js";import"./NavContext-CTH_cL13.js";import"./Nav-BuqLTMK8.js";import"./DataKey-COGXBUcQ.js";import"./useMergedRefs-DpKCltFn.js";import"./useEventCallback-DSfWK9PI.js";const R=()=>N.get("/user").then(t=>t.data),V=t=>N.post("/user",t).then(r=>r.data),q=(t,r)=>N.patch(`/user/${t}`,r).then(i=>i.data),w=({isOpen:t,toggle:r,refetch:i,user:s,setUser:o})=>{const[a]=c.useForm(),{isLoading:n,mutateAsync:l}=b(async d=>V(d)),{isLoading:x,mutateAsync:m}=b(async d=>q(s.id,d)),u=d=>{s?m(d,{onSuccess:()=>{h.success("Success!"),a.resetFields(),i(),o(null)},onError:()=>{h.error("Error!")}}):l(d,{onSuccess:()=>{h.success("Success!"),a.resetFields(),i(),r()},onError:()=>{h.error("Error!")}})};return g.useEffect(()=>{s&&(a.setFieldValue("username",s.username),a.setFieldValue("email",s.email),a.setFieldValue("phone",s.phone))},[s]),e.jsx(P,{title:s?"Edit User":"Add User",open:t||!!s,onClose:()=>{s?o(null):r()},onCancel:()=>{s?o(null):r()},footer:null,destroyOnClose:!0,children:e.jsxs(c,{className:"mt-3",name:"basic",onFinish:u,autoComplete:"off",form:a,children:[e.jsx(c.Item,{label:"Name",name:"username",rules:[{required:!0,message:"Please enter user's name"}],children:e.jsx(C,{})}),e.jsx(c.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please enter user's Email"},{type:"email"}],children:e.jsx(C,{})}),e.jsx(c.Item,{label:"Phone Number",name:"phone",rules:[{required:!0,message:"Please enter user's Phone number"}],children:e.jsx(C,{})}),e.jsx(y,{className:"justify-content-end",children:e.jsx(c.Item,{label:null,children:e.jsx(p,{type:"primary",htmlType:"submit",loading:x||n,children:s?"Update User":"Add User"})})})]})})},Q=()=>{const{isLoading:t,refetch:r,isFetching:i,data:s}=I(["get-all-users"],async()=>R(),{...O}),o=g.useMemo(()=>{},[s==null?void 0:s.data]);return{isLoading:t,isFetching:i,categoryObject:o,data:s==null?void 0:s.data,refetch:r}},_=({data:t,isFetching:r,setUser:i,setUserOrder:s,toggleCreateOrder:o})=>{const a=[{title:"Name",dataIndex:"username",key:"username"},{title:"Email",dataIndex:"email",key:"email"},{title:"Phone",dataIndex:"phone",key:"phone"},{title:"Created at",dataIndex:"createdAt",key:"createdAt",render:(n,l)=>e.jsx("div",{children:A(n)})},{title:"Action",dataIndex:"action",key:"action",render:(n,l)=>e.jsxs(y,{style:{gap:5},children:[e.jsx(p,{onClick:()=>{i(l)},children:"Edit"}),e.jsx(p,{onClick:()=>{s(l),o()},children:"Create order"})]})}];return e.jsx(f,{children:e.jsx(f.Body,{children:e.jsx(v,{rowKey:n=>n.id,loading:r,columns:a,dataSource:t})})})},$=({userId:t,isOpen:r,toggle:i,username:s})=>{const[o]=c.useForm(),a=U(),{isLoading:n,mutateAsync:l}=b(async m=>B(m)),x=m=>{t&&l({userId:t},{onSuccess:u=>{h.success("Order successfully created!"),o.resetFields(),a(`/store/orders/${u==null?void 0:u.id}`)},onError:()=>{h.error("Error creating Order")}})};return g.useEffect(()=>{t&&s&&o.setFieldValue("name",s)},[t,s]),e.jsx(P,{title:"Create order",open:r,onClose:i,onCancel:i,footer:null,destroyOnClose:!0,children:e.jsxs(c,{className:"mt-3",name:"basic",onFinish:x,autoComplete:"off",form:o,children:[e.jsx(c.Item,{label:"Customer name",name:"name",rules:[{required:!0,message:"Please enter user's name"}],children:e.jsx(C,{disabled:!0})}),e.jsx(y,{className:"justify-content-end",children:e.jsx(c.Item,{label:null,children:e.jsx(p,{type:"primary",htmlType:"submit",loading:n,children:"Create Order"})})})]})})},ye=()=>{const{isOpen:t,toggle:r}=F(),{isOpen:i,toggle:s}=F(),[o,a]=g.useState(),[n,l]=g.useState(),{isFetching:x,data:m,refetch:u}=Q(),d=M();return e.jsxs(S,{spinning:x,children:[e.jsx(w,{user:o,isOpen:t,toggle:r,refetch:u,setUser:a}),e.jsx($,{userId:n==null?void 0:n.id,username:n==null?void 0:n.username,isOpen:i,toggle:s,setUserOrder:l}),e.jsx(k,{title:"Customers"}),e.jsx(L,{children:e.jsx(E,{children:e.jsx(f,{children:e.jsx("div",{className:"d-flex align-items-center justify-content-end",children:e.jsxs(p,{onClick:r,className:"btn btn-danger my-2 ",children:[e.jsx("i",{className:"mdi mdi-plus-circle me-2"})," Add Customer"]})})})})}),d?e.jsx(e.Fragment,{children:e.jsx(T,{data:m||[],itemsPerPage:30,height:700,RenderComponent:({item:j})=>e.jsx(E,{md:6,xl:3,children:e.jsx(f,{className:"product-box",children:e.jsx(f.Body,{children:e.jsxs(y,{className:"align-items-center justify-content-sm-between",children:[e.jsxs("div",{className:"col",children:[e.jsx("h5",{className:"font-16 mt-0 sp-line-1",children:e.jsxs("div",{className:"text-dark",children:["Name: ",j.username]})}),e.jsx("h5",{className:"font-16 mt-0 sp-line-1",children:e.jsxs("div",{className:"text-dark",children:["Email: ",j.email]})}),e.jsx("h5",{className:"font-16 mt-0 sp-line-1",children:e.jsxs("div",{className:"text-dark",children:["Phone: ",j.phone]})})]}),e.jsxs(y,{style:{flexDirection:"column",gap:5},children:[e.jsx(p,{variant:"solid",children:"Create order"}),e.jsx(p,{variant:"outlined",onClick:()=>{a(j)},children:"Edit"})]})]})})})},j.id)})}):e.jsx(_,{toggleCreateOrder:s,setUserOrder:l,setUser:a,data:m,isFetching:x})]})};export{ye as default};

import{r as i,c as F,j as l}from"./index-yuUUyctO.js";import{av as le,G as ce,aw as ie,ag as de,ax as ue,u as R,F as V,B as q,a as W,P as ge}from"./constand-2MzKY2H2.js";import{u as H,s as $}from"./index-CaWbZqE4.js";import{g as pe}from"./categoryGroup-iGAh7MsX.js";import{l as me,r as Ce,n as U,m as fe,F as he,C as D,ab as Q,aM as ye,a as N}from"./index-CBw9tgfC.js";import{u as be,p as _,F as S}from"./index-D7ZmTkAm.js";import{M as xe}from"./index-BEr-eB6r.js";import{I as Se}from"./index-KHWGqfV2.js";import{S as je}from"./index-B81dbxI5.js";import{u as $e}from"./useDisclosure-BnWxVtk_.js";import{C as E}from"./Card-BQqG1lle.js";import{F as Ie}from"./Table-CSOoNIQu.js";import{R as Oe}from"./Row-Bd_6pW-A.js";import{C as L}from"./Col-C9voJz8y.js";import{B as Te}from"./Button-B0wmy4O4.js";import"./Anchor-Dl5sMHsj.js";import"./useEventCallback-D9iA8xtn.js";import"./Button-p2pLIQWZ.js";import"./Input-DPA-4Z3o.js";import"./CardHeaderContext-CR2EohSr.js";import"./addEventListener-MtvHkOBD.js";import"./index-zwwZ_c_4.js";const ve=e=>{const{paddingXXS:o,lineWidth:n,tagPaddingHorizontal:r,componentCls:t,calc:s}=e,a=s(r).sub(n).equal(),u=s(o).sub(n).equal();return{[t]:Object.assign(Object.assign({},Ce(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:a,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${U(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${t}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${t}-close-icon`]:{marginInlineStart:u,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${t}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${t}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:a}}),[`${t}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},P=e=>{const{lineWidth:o,fontSizeIcon:n,calc:r}=e,t=e.fontSizeSM;return fe(e,{tagFontSize:t,tagLineHeight:U(r(e.lineHeightSM).mul(t).equal()),tagIconSize:r(n).sub(r(o).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},w=e=>({defaultBg:new he(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText}),X=me("Tag",e=>{const o=P(e);return ve(o)},w);var Fe=function(e,o){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&o.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,r=Object.getOwnPropertySymbols(e);t<r.length;t++)o.indexOf(r[t])<0&&Object.prototype.propertyIsEnumerable.call(e,r[t])&&(n[r[t]]=e[r[t]]);return n};const Ee=i.forwardRef((e,o)=>{const{prefixCls:n,style:r,className:t,checked:s,onChange:a,onClick:u}=e,p=Fe(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:f,tag:m}=i.useContext(D),h=j=>{a==null||a(!s),u==null||u(j)},C=f("tag",n),[b,c,d]=X(C),O=F(C,`${C}-checkable`,{[`${C}-checkable-checked`]:s},m==null?void 0:m.className,t,c,d);return b(i.createElement("span",Object.assign({},p,{ref:o,style:Object.assign(Object.assign({},r),m==null?void 0:m.style),className:O,onClick:h})))}),Ne=e=>le(e,(o,n)=>{let{textColor:r,lightBorderColor:t,lightColor:s,darkColor:a}=n;return{[`${e.componentCls}${e.componentCls}-${o}`]:{color:r,background:s,borderColor:t,"&-inverse":{color:e.colorTextLightSolid,background:a,borderColor:a},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}}),Pe=Q(["Tag","preset"],e=>{const o=P(e);return Ne(o)},w);function we(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const I=(e,o,n)=>{const r=we(n);return{[`${e.componentCls}${e.componentCls}-${o}`]:{color:e[`color${n}`],background:e[`color${r}Bg`],borderColor:e[`color${r}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},Be=Q(["Tag","status"],e=>{const o=P(e);return[I(o,"success","Success"),I(o,"processing","Info"),I(o,"error","Error"),I(o,"warning","Warning")]},w);var ze=function(e,o){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&o.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,r=Object.getOwnPropertySymbols(e);t<r.length;t++)o.indexOf(r[t])<0&&Object.prototype.propertyIsEnumerable.call(e,r[t])&&(n[r[t]]=e[r[t]]);return n};const Ge=i.forwardRef((e,o)=>{const{prefixCls:n,className:r,rootClassName:t,style:s,children:a,icon:u,color:p,onClose:f,bordered:m=!0,visible:h}=e,C=ze(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:b,direction:c,tag:d}=i.useContext(D),[O,j]=i.useState(!0),J=ce(C,["closeIcon","closable"]);i.useEffect(()=>{h!==void 0&&j(h)},[h]);const B=ie(p),z=ue(p),T=B||z,K=Object.assign(Object.assign({backgroundColor:p&&!T?p:void 0},d==null?void 0:d.style),s),g=b("tag",n),[Z,ee,re]=X(g),oe=F(g,d==null?void 0:d.className,{[`${g}-${p}`]:T,[`${g}-has-color`]:p&&!T,[`${g}-hidden`]:!O,[`${g}-rtl`]:c==="rtl",[`${g}-borderless`]:!m},r,t,ee,re),G=x=>{x.stopPropagation(),f==null||f(x),!x.defaultPrevented&&j(!1)},[,te]=be(_(e),_(d),{closable:!1,closeIconRender:x=>{const ae=i.createElement("span",{className:`${g}-close-icon`,onClick:G},x);return ye(x,ae,y=>({onClick:k=>{var v;(v=y==null?void 0:y.onClick)===null||v===void 0||v.call(y,k),G(k)},className:F(y==null?void 0:y.className,`${g}-close-icon`)}))}}),ne=typeof C.onClick=="function"||a&&a.type==="a",A=u||null,se=A?i.createElement(i.Fragment,null,A,a&&i.createElement("span",null,a)):a,M=i.createElement("span",Object.assign({},J,{ref:o,className:oe,style:K}),se,te,B&&i.createElement(Pe,{key:"preset",prefixCls:g}),z&&i.createElement(Be,{key:"status",prefixCls:g}));return Z(ne?i.createElement(de,{component:"Tag"},M):M)}),Y=Ge;Y.CheckableTag=Ee;const Ae=({payload:e})=>N.post("/category-menu",e).then(o=>o.data),Me=()=>N.get("/category-menu?join=categoryGroups").then(e=>e.data),ke=({id:e,payload:o})=>N.patch(`/category-menu/${e}`,o).then(n=>n.data),He=({isOpen:e,toggle:o,refetch:n,categoryMenu:r,setCategoryMenu:t})=>{var b;const[s]=S.useForm(),{isFetching:a,data:u}=R(["category-groups"],async()=>pe(),{...W}),{isLoading:p,mutateAsync:f}=H(async c=>Ae({payload:c})),{isLoading:m,mutateAsync:h}=H(async c=>ke({id:r.id,payload:c})),C=c=>{r?(console.log({values:c}),h(c,{onSuccess:()=>{$.success("Success!"),s.resetFields(),n(),t(null)},onError:()=>{$.error("Error!")}})):f({name:c.name,categoryGroupIds:c.categoryGroupIds},{onSuccess:()=>{$.success("Success!"),s.resetFields(),n(),o()},onError:()=>{$.error("Error!")}})};return i.useEffect(()=>{r&&(s.setFieldValue("name",r.name),s.setFieldValue("categoryGroupIds",r.categoryGroups?r.categoryGroups.map(c=>c==null?void 0:c.id):[]))},[r]),l.jsx(xe,{title:r?"Edit Category Menu":"Add Category Menu",open:e||!!r,onClose:()=>{r?(s.resetFields(),t(null)):(s.resetFields(),o())},onCancel:()=>{r?(s.resetFields(),t(null)):(s.resetFields(),o())},footer:null,destroyOnClose:!0,children:l.jsxs(S,{className:"mt-3",name:"basic",onFinish:C,autoComplete:"off",form:s,children:[l.jsx(S.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please enter the Category Name!"}],children:l.jsx(Se,{})}),l.jsx(S.Item,{label:"Category Groups",name:"categoryGroupIds",rules:[{required:!0,message:"Please select the category group!",type:"array"}],children:l.jsx(je,{mode:"multiple",loading:a,showSearch:!0,placeholder:"Select a category group",filterOption:(c,d)=>((d==null?void 0:d.label)??"").toLowerCase().includes(c.toLowerCase()),options:(b=u==null?void 0:u.data)==null?void 0:b.map(c=>({value:c.id,label:c.name}))})}),l.jsx(V,{className:"justify-content-end",children:l.jsx(S.Item,{label:null,children:l.jsx(q,{type:"primary",htmlType:"submit",loading:m||p,children:r?"Update Category Menu":"Add Category Menu"})})})]})})},_e=({data:e,isFetching:o,setCategoryMenu:n})=>{const r=[{title:"Name",dataIndex:"name",key:"name",sort:!0},{title:"Category groups",dataIndex:"categoryGroups",key:"categoryGroups",render:(t,s)=>l.jsx("div",{children:s==null?void 0:s.categoryGroups.map(a=>l.jsx(Y,{children:a==null?void 0:a.name},a==null?void 0:a.id))})},{title:"Action",dataIndex:"action",key:"action",render:(t,s)=>l.jsx(q,{onClick:()=>{n(s)},children:"Edit"})}];return l.jsx(E,{children:l.jsx(E.Body,{children:l.jsx(Ie,{columns:r,dataSource:e})})})},ir=()=>{const{isOpen:e,toggle:o}=$e(),[n,r]=i.useState(),{isFetching:t,data:s,refetch:a}=R(["get-category-menu"],Me,{...W});return l.jsxs(l.Fragment,{children:[l.jsx(He,{categoryMenu:n,isOpen:e,toggle:o,refetch:a,setCategoryMenu:r}),l.jsx(ge,{title:"Category Menu"}),l.jsx(Oe,{children:l.jsx(L,{children:l.jsx(E,{children:l.jsx(V,{className:"p-2 justify-content-end",children:l.jsx(Te,{onClick:o,children:"Add"})})})})}),l.jsx(L,{children:l.jsx(_e,{setCategoryMenu:r,data:s==null?void 0:s.data,isFetching:t})})]})};export{ir as default};

import{r as o,j as s,b as D,w as _}from"./index-yuUUyctO.js";import{F as y,B as w,C as A,u as B,a as R,P as H}from"./constand-2MzKY2H2.js";import{d as V}from"./debounce-Bq8f-Q2b.js";import{S}from"./index-B81dbxI5.js";import{S as M}from"./index-CBw9tgfC.js";import{T as O,a as W,g as Y,D as z}from"./product-3Nsfrse4.js";import{u as T,s as g}from"./index-CaWbZqE4.js";import{a as G,u as J,b as K,d as X}from"./order-Ce9Igb29.js";import{M as Z}from"./index-BEr-eB6r.js";import{F as P}from"./index-D7ZmTkAm.js";import{I}from"./index-CXAPcKyC.js";import{u as L}from"./useDisclosure-BnWxVtk_.js";import{P as C}from"./index-CMP0OeXV.js";import{C as f}from"./Col-C9voJz8y.js";import{f as Q}from"./format-DT9SbUHr.js";import{P as ss}from"./index-dSw5Ci7g.js";import{R as m}from"./Row-Bd_6pW-A.js";import{C as b}from"./Card-BQqG1lle.js";import{u as ns}from"./useTranslation-BT0VEfT5.js";import{B as es}from"./Button-B0wmy4O4.js";import"./Anchor-Dl5sMHsj.js";import"./useEventCallback-D9iA8xtn.js";import"./Button-p2pLIQWZ.js";import"./addEventListener-MtvHkOBD.js";import"./CardHeaderContext-CR2EohSr.js";function is({fetchOptions:n,debounceTimeout:l=800,onSelect:r,...i}){const[t,e]=o.useState(!1),[h,c]=o.useState([]),u=o.useRef(0),x=o.useMemo(()=>V(j=>{if(!j)return;u.current+=1;const d=u.current;e(!0),n(j).then(a=>{d===u.current&&(c(a),e(!1))})},l),[n,l]);return s.jsx(S,{labelInValue:!0,filterOption:!1,onSearch:x,onSelect:r,notFoundContent:t?s.jsx(M,{size:"small"}):null,...i,options:h})}async function ls(n){const l=`&filter=name||$contL||${n}`;return(await W({filter:l})).data.map(i=>{var t,e;return{label:s.jsxs(y,{style:{justifyContent:"space-between",paddingRight:10},children:[s.jsxs(y,{style:{gap:5,alignItems:"center"},children:[s.jsx(I,{style:{height:50,width:50,objectFit:"cover"},src:(e=(t=i==null?void 0:i.productImages)==null?void 0:t[0])==null?void 0:e.file.thumbnailUrl}),i.name]}),s.jsxs(y,{style:{alignItems:"center"},children:[i==null?void 0:i.quantity," In Stock"]}),s.jsxs(y,{style:{alignItems:"center"},children:[i==null?void 0:i.price," ",A]})]}),value:i.id}})}const ts=({isOpen:n,toggle:l,refetch:r,id:i})=>{const[t,e]=o.useState(""),{isLoading:h,mutateAsync:c}=T(async x=>G(x)),u=x=>{const p={id:i,productId:t,quantity:x.quantity,price:x==null?void 0:x.price};c(p,{onSuccess:()=>{g.success("Product added to order!"),r(),l()},onError:()=>{g.error("Product added to order!")}})};return s.jsx(Z,{width:"45rem",title:"Product",open:n,onClose:()=>{e(""),l()},onCancel:()=>{e(""),l()},footer:null,destroyOnClose:!0,children:s.jsxs(P,{name:"basic",onFinish:u,autoComplete:"off",children:[s.jsx(P.Item,{label:"Product",name:"name",rules:[{required:!0,message:"Please select a product"}],children:s.jsx(is,{showSearch:!0,placeholder:"Select product",fetchOptions:ls,style:{width:"100%",height:70},onSelect:({value:x},p)=>{e(x)}})}),s.jsx(P.Item,{label:"Quantity",name:"quantity",rules:[{required:!0,message:"Please enter quantity in stock"}],children:s.jsx(O,{min:1})}),s.jsx(y,{className:"justify-content-end",children:s.jsx(P.Item,{label:null,children:s.jsx(w,{type:"primary",htmlType:"submit",children:"Update"})})})]})})},cs=({orderItem:n,refetch:l})=>{var x,p,j,d,a,N,q,k,E,F,U;const[r,i]=o.useState(n==null?void 0:n.quantity),[t,e]=o.useState(n!=null&&n.price?n.price:(x=n==null?void 0:n.product)==null?void 0:x.price),{data:h}=B(["get-single-product",n.productId],()=>Y(n==null?void 0:n.productId),{...R}),{isLoading:c,mutateAsync:u}=T(async v=>J(n==null?void 0:n.id,v));return s.jsxs("tr",{children:[s.jsx("th",{scope:"row",style:{display:"flex",alignItems:"center"},children:(p=n==null?void 0:n.product)==null?void 0:p.name}),s.jsx("td",{children:s.jsx("img",{src:(a=(d=(j=h==null?void 0:h.productImages)==null?void 0:j[0])==null?void 0:d.file)==null?void 0:a.thumbnailUrl,alt:"",height:"32"})}),s.jsx("td",{children:s.jsx(C,{content:s.jsxs(f,{children:[s.jsx(O,{style:{width:"12rem"},min:1,value:r,onChange:v=>i(v)}),s.jsx(y,{style:{alignItems:"flex-end",justifyContent:"flex-end"},children:s.jsx(w,{loading:c,disabled:n.quantity===r||!r,variant:"filled",style:{marginTop:10},onClick:()=>{u({quantity:r},{onSuccess:()=>{g.success("Order has been updated successfully!"),l()},onError:()=>{g.error("Error updating Order")}})},children:"Update"})})]}),title:"Update Quantity",trigger:"click",children:s.jsx("div",{children:n.quantity})})}),s.jsx("td",{children:s.jsx(C,{content:s.jsxs(f,{children:[s.jsxs(y,{style:{flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",marginBottom:"1rem",gap:5},children:[s.jsxs("div",{className:"text-center",children:["Product price: ",(N=n==null?void 0:n.product)==null?void 0:N.price]}),s.jsxs("div",{className:"text-center",children:["Sold price: ",(n==null?void 0:n.price)||((q=n==null?void 0:n.product)==null?void 0:q.price)]})]}),s.jsx(O,{style:{width:"12rem"},min:1,max:(k=n==null?void 0:n.product)==null?void 0:k.price,value:t,onChange:v=>e(v)}),s.jsx(y,{style:{alignItems:"flex-end",justifyContent:"flex-end"},children:s.jsx(w,{loading:c,disabled:n.price?t===(n==null?void 0:n.price):t===((E=n==null?void 0:n.product)==null?void 0:E.price),variant:"filled",style:{marginTop:10},onClick:()=>{u({price:t},{onSuccess:()=>{g.success("Order has been updated successfully!"),l()},onError:()=>{g.error("Error updating Order")}})},children:"Update"})})]}),title:"Update Price",trigger:"click",children:s.jsx("div",{children:n!=null&&n.price?n.price:(F=n==null?void 0:n.product)==null?void 0:F.price})})}),s.jsx("td",{children:n!=null&&n.price?n.price*(n==null?void 0:n.quantity):((U=n==null?void 0:n.product)==null?void 0:U.price)*n.quantity})]})},as=({refetch:n,order:l})=>{const{isOpen:r,toggle:i}=L(),t=o.useMemo(()=>{var h;let e=0;return(h=l==null?void 0:l.orderProducts)==null||h.forEach(c=>{var u;e+=c!=null&&c.price?(c==null?void 0:c.quantity)*(c==null?void 0:c.price):(c==null?void 0:c.quantity)*((u=c==null?void 0:c.product)==null?void 0:u.price)}),e},[l]);return s.jsxs(s.Fragment,{children:[s.jsx(ts,{isOpen:r,toggle:i,refetch:n,id:l==null?void 0:l.id}),s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-bordered table-centered mb-0",children:[s.jsx("thead",{className:"table-light",children:s.jsxs("tr",{children:[s.jsx("th",{children:"Product name"}),s.jsx("th",{children:"Product"}),s.jsx("th",{children:"Quantity"}),s.jsx("th",{children:"Price"}),s.jsx("th",{children:"Total"})]})}),s.jsxs("tbody",{children:[((l==null?void 0:l.orderProducts)||[]).map((e,h)=>s.jsx(cs,{orderItem:e,refetch:n},h)),s.jsxs("tr",{children:[s.jsx("th",{scope:"row",children:s.jsx(w,{onClick:i,children:"+"})}),s.jsx("td",{}),s.jsx("td",{}),s.jsx("td",{}),s.jsx("td",{})]}),s.jsxs("tr",{children:[s.jsx("th",{scope:"row",colSpan:4,className:"text-end",children:"Sub Total :"}),s.jsx("td",{children:s.jsx("div",{className:"fw-bold",children:t})})]}),s.jsxs("tr",{children:[s.jsx("th",{scope:"row",colSpan:4,className:"text-end",children:"Total :"}),s.jsx("td",{children:s.jsxs("div",{className:"fw-bold",children:[" ",t]})})]})]})]})})]})},rs=({itemNumber:n,quantity:l,price:r,productItem:i})=>{var e,h;const t=o.useMemo(()=>r*l,[i,l]);return s.jsxs("tr",{children:[s.jsx("td",{children:n+1}),s.jsxs("td",{children:[s.jsx("b",{children:(e=i==null?void 0:i.product)==null?void 0:e.name})," ",s.jsx("br",{}),ss(((h=i==null?void 0:i.product)==null?void 0:h.description)||"")]}),s.jsx("td",{children:l}),s.jsx("td",{children:r}),s.jsx("td",{className:"text-end",children:t})]},i==null?void 0:i.id)},hs=({user:n,products:l,isOpen:r,toggle:i,order:t})=>{var j;const e=o.useRef(null),[h]=o.useState("Thanks a lot because you keep purchasing our products. Our company promises to provide high quality products for you as well as outstanding customer service for every transaction."),[c,u]=o.useState([]),x=()=>{if(!e.current)return;const d=e.current.innerHTML,a=window.open("","_blank");a&&(a.document.write(`
      <html>
        <head>
          <title>Technoland</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
          </style>
        </head>
        <body>
          ${d}
        </body>
      </html>
    `),a.document.close(),a.print())},p=o.useMemo(()=>{let d=0;return l==null||l.forEach(a=>{d+=a.price?(a==null?void 0:a.quantity)*a.price:(a==null?void 0:a.quantity)*a.product.price}),d},[c]);return s.jsx(s.Fragment,{children:s.jsxs(z,{open:r,onClose:i,destroyOnClose:!0,width:1200,height:500,children:[s.jsx(m,{ref:e,children:s.jsx(f,{children:s.jsx(b,{children:s.jsxs(b.Body,{children:[s.jsxs("div",{className:"clearfix",children:[s.jsx("div",{className:"float-start",children:s.jsx("div",{className:"auth-logo",children:s.jsx("div",{className:"logo logo-dark",children:s.jsx("span",{className:"logo-lg",children:s.jsx("img",{src:D.logo,alt:"",height:"22"})})})})}),s.jsx("div",{className:"float-end",children:s.jsxs("h4",{className:"m-0 d-print-none",children:[s.jsx("span",{children:"Invoice from"}),s.jsxs("span",{children:[" ",D.name]})]})})]}),s.jsxs(m,{children:[s.jsx(f,{md:6,children:s.jsxs("div",{className:"mt-3",children:[s.jsx("p",{children:s.jsxs("b",{children:["Hello, ",(j=t==null?void 0:t.user)==null?void 0:j.username]})}),s.jsx("p",{className:"text-muted",children:h})]})}),s.jsx(f,{md:{span:4,offset:2},children:s.jsxs("div",{className:"mt-3 float-end",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Order Date : "})," ",s.jsxs("span",{className:"float-end",children:[" ","   "," ",Q(t==null?void 0:t.createAt)," "]})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Order No. : "}),s.jsxs("span",{className:"float-end",children:[" ",s.jsx("span",{className:"float-end",children:t==null?void 0:t.orderId})]})]})]})})]}),s.jsx(m,{children:s.jsx(f,{xs:12,children:s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table mt-4 table-centered",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"#"}),s.jsx("th",{children:"Item"}),s.jsx("th",{style:{width:"10%"},children:"Quantity"}),s.jsx("th",{style:{width:"10%"},children:"Price"}),s.jsx("th",{style:{width:"10%"},className:"text-end",children:"Total"})]})}),s.jsx("tbody",{children:(l||[]).map((d,a)=>{var N;return s.jsx(rs,{price:d!=null&&d.price?d==null?void 0:d.price:(N=d.product)==null?void 0:N.price,quantity:d.quantity,itemNumber:a,productItem:d},a)})})]})})})}),s.jsxs(m,{style:{display:"flex",justifyContent:"space-between",marginTop:"2rem"},children:[s.jsx(f,{children:s.jsxs("div",{style:{border:"1px solid #000",padding:"20px",width:"100%",maxWidth:"250px",height:"100px",textAlign:"center"},children:[s.jsx("p",{children:s.jsx("b",{children:"Signature:"})}),s.jsx("div",{style:{width:"100%",height:"60px",borderBottom:"1px solid #000",marginTop:"10px"}})]})}),s.jsxs(f,{children:[s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("b",{children:"Sub-total:"})," ",s.jsx("span",{children:p})]}),s.jsxs("h3",{children:[p," ",A]})]}),s.jsx("div",{style:{clear:"both"}})]})]})]})})})}),s.jsx("div",{className:"mt-4 mb-1",children:s.jsxs("div",{className:"text-end d-print-none",children:[s.jsxs("button",{className:"btn btn-primary waves-effect waves-light me-1",onClick:x,children:[s.jsx("i",{className:"mdi mdi-printer me-1"})," Print"]}),s.jsx("button",{className:"btn btn-info waves-effect waves-light",children:"Submit"})]})})]})})};var $=(n=>(n.Unpaid="Unpaid",n.Paid="Paid",n.PaymentInCompleted="PaymentInCompleted",n))($||{});const As=()=>{var x,p;const n=_(),{isOpen:l,toggle:r}=L(),{t:i}=ns(),{isFetching:t,data:e,refetch:h}=B(["get-single-order",n==null?void 0:n.id],()=>K(n==null?void 0:n.id),{...R}),{isLoading:c,mutateAsync:u}=T(async j=>X(e==null?void 0:e.id,j));return s.jsxs(M,{spinning:t,children:[s.jsx(H,{title:"Order Detail"}),s.jsx(hs,{isOpen:l,toggle:r,products:e==null?void 0:e.orderProducts,user:e==null?void 0:e.user,order:e}),s.jsxs(m,{children:[s.jsx(f,{lg:4,children:s.jsx(b,{children:s.jsxs(b.Body,{children:[s.jsx("h4",{className:"header-title mb-3",children:"Track Order"}),s.jsxs(m,{children:[s.jsx(f,{lg:6,children:s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{className:"mt-0",children:"Order ID:"}),s.jsx("p",{children:e==null?void 0:e.orderId})]})}),s.jsx(f,{lg:6,children:s.jsxs("div",{className:"mb-4",children:[s.jsx("h5",{className:"mt-0",children:"Name:"}),s.jsx("p",{children:(x=e==null?void 0:e.user)==null?void 0:x.username})]})})]}),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"track-order-list",children:[s.jsxs("ul",{className:"list-unstyled",children:[s.jsxs("li",{className:"completed",children:[s.jsx("h5",{className:"mt-0 mb-1",children:"Order Placed"}),s.jsxs("p",{className:"text-muted",children:[Q(e==null?void 0:e.createAt)," ",s.jsx("small",{className:"text-muted",children:"07:22 AM"})," "]})]}),s.jsx("li",{className:`${(e==null?void 0:e.status)==="Delivered"&&"completed"}`,children:s.jsx("h5",{className:"mt-0 mb-1",children:" Delivered"})})]}),s.jsx("div",{className:"text-center mt-4",children:s.jsx(es,{disabled:((p=e==null?void 0:e.orderProducts)==null?void 0:p.length)<1,onClick:r,className:"btn btn-primary",children:"Show Invoice"})})]})})]})})}),s.jsx(f,{lg:8,children:s.jsx(b,{children:s.jsxs(b.Body,{children:[s.jsxs(y,{className:"justify-content-between",children:[s.jsxs("h4",{className:"header-title mb-3",children:["Items from Order ",e==null?void 0:e.orderId]}),s.jsx(C,{content:s.jsx(S,{value:e==null?void 0:e.paymentStatus,style:{width:"12rem"},onSelect:j=>{u({paymentStatus:j},{onSuccess:()=>{g.success("Payment status updated"),h()},onError:()=>{g.error("An error occured")}})},children:Object.values($).map(j=>s.jsx(S.Option,{value:j,children:i(j)},j))}),title:"Update status",trigger:"click",children:s.jsxs("h4",{className:"header-title mb-3 bg-info p-1 ",style:{cursor:"pointer"},children:["Payment status: ",i(e==null?void 0:e.paymentStatus)]})})]}),s.jsx(as,{refetch:h,order:e})]})})})]})]})};export{As as default};
